List of English Movies

SELECT title, year, genre, director, duration
FROM movies
WHERE language = "English"
ORDER BY year DESC;


List of Universally-acclaimed Movies 

SELECT title, year, genre, director, metascore
FROM movies
WHERE metascore >= 81
ORDER BY metascore DESC;


Top 10 Production Companies and their Highest-rated Film

SELECT T1.production_company,
COUNT(T1.production_company) AS number_of_movies,
FORMAT(AVG(T1.weighted_average_vote), 2) 
AS average_vote_of_movies
FROM 
(SELECT m.imdb_title_id, m.production_company,
r.weighted_average_vote
FROM Movies m
JOIN Ratings r
ON m.imdb_title_id = r.imdb_title_id) AS T1
GROUP BY T1.production_company
HAVING number_of_movies >= 200
ORDER BY average_vote_of_movies DESC
LIMIT 10;

SELECT production_company, title, year, genre, director,
duration, MAX(weighted_average_vote) AS rating
FROM Movies m
JOIN Ratings r ON m.imdb_title_id = r.imdb_title_id
WHERE production_company IN
(SELECT production_company
FROM 
(SELECT T1.production_company,
COUNT(T1.production_company) AS number_of_movies,
AVG(T1.weighted_average_vote) AS 
average_vote_of_movies
FROM 
(SELECT m.imdb_title_id, m.production_company,
r.weighted_average_vote
FROM Movies m
JOIN Ratings r
ON m.imdb_title_id = r.imdb_title_id) AS T1
GROUP BY T1.production_company
HAVING number_of_movies >= 200
ORDER BY average_vote_of_movies DESC
LIMIT 10) 
AS T2)
GROUP BY production_company
ORDER BY rating DESC;


Filmography of a Specific Actor/Actress

SELECT COUNT(*) AS count_films
FROM Movies, Title_principals, Names
WHERE Names.imdb_name_id = Title_principals.imdb_name_id 
 AND Title_principals.imdb_title_id = Movies.imdb_title_id
 AND (Title_principals.category = "actor" OR 
Title_principals.category = "actress")
 AND Names.name like "%Bruce Lee%";

SELECT title, year, genre, director, duration
FROM Movies, Title_principals, Names
WHERE Names.imdb_name_id = Title_principals.imdb_name_id 
 AND Title_principals.imdb_title_id = Movies.imdb_title_id
AND (Title_principals.category = "actor" OR 
Title_principals.category = "actress")
 AND Names.name like "%Bruce Lee%";


The Best and Worst Films of Each Year According to Ratings

SELECT DISTINCT T1.year, m1.title, m1.director, 
 COALESCE(tp1.job,'None') AS job, T1.Ratings
FROM MOVIES m1, RATINGS r1, TITLE_PRINCIPALS tp1,
( SELECT m2.year, 
   	    MAX(r2.weighted_average_vote) AS 'Ratings'
 	 FROM MOVIES m2, RATINGS r2
      WHERE r2.imdb_title_id=m2.imdb_title_id
      GROUP BY m2.year
     ) T1
WHERE (T1.year = m1.year 
 AND T1.Ratings = r1.weighted_average_vote)
 AND r1.imdb_title_id=m1.imdb_title_id
 AND m1.imdb_title_id=tp1.imdb_title_id
 AND tp1.category ="director"
 AND T1.year LIKE "%%"
ORDER BY year ASC;

SELECT DISTINCT T1.year, m1.title, m1.director, 
 COALESCE(tp1.job,'None') AS job, T1.Ratings
FROM MOVIES m1, RATINGS r1, TITLE_PRINCIPALS tp1,
( SELECT m2.year, 
   	    MIN(r2.weighted_average_vote) AS 'Ratings'
 	 FROM MOVIES m2, RATINGS r2
      WHERE r2.imdb_title_id=m2.imdb_title_id
      GROUP BY m2.year
     ) T1
WHERE (T1.year = m1.year 
 AND T1.Ratings = r1.weighted_average_vote)
 AND r1.imdb_title_id=m1.imdb_title_id
 AND m1.imdb_title_id=tp1.imdb_title_id
 AND tp1.category ="director"
 AND T1.year LIKE "%%"
ORDER BY year ASC;


Job and/or Character Played by a Particular Person in a Film

SELECT T1.Ordering, N.name, M.title, IFNULL(P.category, 'None') 
AS 'Job', TRIM(TRAILING ']' FROM TRIM(LEADING '[' 
FROM(REPLACE(IFNULL(P.characters, 'None'), '"', '')))) AS 'Characters'
FROM title_principals P, movies M, names N,
(SELECT AVG(P1.ordering) AS 'Ordering', N1.imdb_name_id
	 FROM title_principals P1, movies M1, names N1
	 WHERE N1.imdb_name_id = P1.imdb_name_id 
	 AND P1.imdb_title_id = M1.imdb_title_id
	 AND N1.name LIKE "%Fred Astaire%"
	 GROUP BY N1.name) T1
WHERE T1.imdb_name_id=N.imdb_name_id
	 AND N.imdb_name_id = P.imdb_name_id 
 	 AND P.imdb_title_id = M.imdb_title_id;


Best Year in Film for a Specific Person and the Best Movie in that Given Year

SELECT name, year, b.best_year_rating, title,  max(weighted_average_vote) as movie_rating, job, characters
FROM names n , title_principals t, movies m, ratings r, 
	(SELECT a.name as best_name, a.year as best_year, 
max(year_rating) as best_year_rating
	FROM ( SELECT name, year, avg(weighted_average_vote) 
as year_rating
			FROM names n , title_principals t, movies m,
ratings r
			WHERE n.imdb_name_id = t.imdb_name_id 
				AND t.imdb_title_id = m.imdb_title_id 
				AND m.imdb_title_id = r.imdb_title_id
				AND name LIKE "%Fred Astaire%"
			GROUP BY name, year
			ORDER BY name) a
	GROUP BY a.name
	ORDER BY a.name)b
WHERE n.imdb_name_id = t.imdb_name_id 
	AND t.imdb_title_id = m.imdb_title_id 
AND m.imdb_title_id = r.imdb_title_id
    	AND n.name = b.best_name 
    	AND m.year = b.best_year
GROUP BY name
ORDER BY name;


